<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
    <bean class="com.epam.pipeline.dao.tool.ToolVulnerabilityDao" id="toolVulnerabilityDao" autowire="byName">
        <property name="insertVulnerabilitiesQuery">
            <value>
                <![CDATA[
                    INSERT INTO pipeline.tool_vulnerability (
                        tool_id,
                        version,
                        vulnerability_name,
                        feature,
                        feature_version,
                        description,
                        link,
                        severity,
                        fixed_by,
                        created_date
                    ) VALUES (
                        :TOOL_ID,
                        :VERSION,
                        :VULNERABILITY_NAME,
                        :FEATURE,
                        :FEATURE_VERSION,
                        :DESCRIPTION,
                        :LINK,
                        :SEVERITY,
                        :FIXED_BY,
                        :CREATED_DATE
                    )
                ]]>
            </value>
        </property>
        <property name="loadVulnerabilitiesByToolAndVersionQuery">
            <value>
                <![CDATA[
                    SELECT
                        tv.vulnerability_name,
                        tv.feature,
                        tv.feature_version,
                        tv.description,
                        tv.link,
                        tv.severity,
                        tv.fixed_by,
                        tv.created_date
                    FROM
                        pipeline.tool_vulnerability tv
                    WHERE
                        tv.tool_id = :TOOL_ID
                        AND tv.version = :VERSION
                ]]>
            </value>
        </property>
        <property name="loadVulnerabilitiesByToolQuery">
            <value>
                <![CDATA[
                    SELECT
                        tv.version,
                        tv.vulnerability_name,
                        tv.feature,
                        tv.feature_version,
                        tv.description,
                        tv.link,
                        tv.severity,
                        tv.fixed_by,
                        tv.created_date
                    FROM
                        pipeline.tool_vulnerability tv
                    WHERE
                        tv.tool_id = ?
                ]]>
            </value>
        </property>
        <property name="deleteVulnerabilitiesQuery">
            <value>
                <![CDATA[
                    DELETE FROM pipeline.tool_vulnerability
                    WHERE
                        tool_id = :TOOL_ID
                        AND version = :VERSION
                ]]>
            </value>
        </property>
        <property name="insertToolDependencyQuery">
            <value>
                <![CDATA[
                    INSERT INTO pipeline.tool_dependency (
                        tool_id,
                        tool_version,
                        dependency_name,
                        dependency_version,
                        dependency_ecosystem,
                        dependency_description
                    ) VALUES (
                        :TOOL_ID,
                        :TOOL_VERSION,
                        :DEPENDENCY_NAME,
                        :DEPENDENCY_VERSION,
                        :DEPENDENCY_ECOSYSTEM,
                        :DEPENDENCY_DESCRIPTION
                    )
                ]]>
            </value>
        </property>
        <property name="loadDependencyByToolAndVersionQuery">
            <value>
                <![CDATA[
                    SELECT
                        d.tool_id,
                        d.tool_version,
                        d.dependency_name,
                        d.dependency_version,
                        d.dependency_ecosystem,
                        d.dependency_description
                    FROM
                        pipeline.tool_dependency d
                    WHERE
                        d.tool_id = :TOOL_ID
                        AND d.tool_version = :TOOL_VERSION
                ]]>
            </value>
        </property>
        <property name="loadDependencyByToolQuery">
            <value>
                <![CDATA[
                    SELECT
                        d.tool_id,
                        d.tool_version,
                        d.dependency_name,
                        d.dependency_version,
                        d.dependency_ecosystem,
                        d.dependency_description
                    FROM
                        pipeline.tool_dependency d
                    WHERE
                        d.tool_id = ?
                ]]>
            </value>
        </property>
        <property name="deleteDependencyQuery">
            <value>
                <![CDATA[
                    DELETE FROM pipeline.tool_dependency
                    WHERE
                        tool_id = :TOOL_ID
                        AND tool_version = :TOOL_VERSION
                ]]>
            </value>
        </property>
        <property name="insertToolVersionScanQuery">
            <value>
                <![CDATA[
                    INSERT INTO pipeline.tool_version_scan (
                        tool_id,
                        version,
                        layer_reference,
                        digest,
                        scan_status,
                        scan_date,
                        success_scan_date
                    ) VALUES (
                        :TOOL_ID,
                        :VERSION,
                        :LAYER_REFERENCE,
                        :DIGEST,
                        :SCAN_STATUS,
                        :SCAN_DATE,
                        :SUCCESS_SCAN_DATE
                    )
                ]]>
            </value>
        </property>
        <property name="updateToolVersionScanQuery">
            <value>
                <![CDATA[
                    UPDATE pipeline.tool_version_scan
                    SET
                        layer_reference=:LAYER_REFERENCE,
                        digest=:DIGEST,
                        scan_status=:SCAN_STATUS,
                        scan_date=:SCAN_DATE,
                        white_list=:WHITE_LIST
                    WHERE
                        tool_id=:TOOL_ID
                        AND version=:VERSION
                ]]>
            </value>
        </property>
        <property name="updateWhiteListWithToolVersionQuery">
            <value>
                <![CDATA[
                    UPDATE pipeline.tool_version_scan
                    SET
                        white_list=:WHITE_LIST
                    WHERE
                        tool_id=:TOOL_ID
                        AND version=:VERSION
                ]]>
            </value>
        </property>
        <property name="updateToolVersionScanWithSuccessQuery">
            <value>
                <![CDATA[
                    UPDATE pipeline.tool_version_scan
                    SET
                        layer_reference=:LAYER_REFERENCE,
                        digest=:DIGEST,
                        scan_status=:SCAN_STATUS,
                        scan_date=:SCAN_DATE,
                        success_scan_date=:SUCCESS_SCAN_DATE,
                        white_list=:WHITE_LIST
                    WHERE
                        tool_id=:TOOL_ID
                        AND version=:VERSION
                ]]>
            </value>
        </property>
        <property name="loadToolVersionScanQuery">
            <value>
                <![CDATA[
                    SELECT
                        tool_id,
                        version,
                        layer_reference,
                        digest,
                        scan_date,
                        success_scan_date,
                        scan_status,
                        white_list
                    FROM
                        pipeline.tool_version_scan
                    WHERE
                        tool_id = :TOOL_ID
                        AND version = :VERSION
                ]]>
            </value>
        </property>
        <property name="loadToolAllVersionScansQuery">
            <value>
                <![CDATA[
                    SELECT
                        tool_id,
                        version,
                        layer_reference,
                        digest,
                        scan_date,
                        success_scan_date,
                        scan_status,
                        white_list
                    FROM
                        pipeline.tool_version_scan
                    WHERE
                        tool_id = :TOOL_ID
                ]]>
            </value>
        </property>
        <property name="deleteToolVersionScansQuery">
            <value>
                <![CDATA[
                    DELETE FROM pipeline.tool_version_scan
                    WHERE
                        tool_id = :TOOL_ID
                        AND version = :VERSION
                ]]>
            </value>
        </property>
    </bean>
</beans>