# Archiving: Create transition rule

Test verifies 
- *Create transition rule* pop-up
- that storage owner can create transition rule 

**Prerequisites**:

- admin user
- non-admin `User1` with the ROLE_STORAGE_MANAGER role

**Preparations**:
1. Login as the admin user from the prerequisites and create *folder*
2. Give **WRITE** permission on *folder* to the non-admin *User1* from the Prerequisites
3. Logout and login as non-admin `User1` from the Prerequisites
4. Open the *folder* created at step 1. Create *storage*.

| Steps | Actions | Expected results |
| :---: | --- | --- |
| 1 | Open the **Library** page | |
| 2 | Open a storage created at step 4 from the Preparations | |
| 3 | Click gear icon to open storage settings | **Edit object storage** pop-up contains 3 tabs: ***Info***, ***Permissions***, ***Transition rules***  |
| 4 | Click the ***Transition rules*** tab | ***Transition rules*** tab opens that contains **+ Create** button |
| 5 | Click **+ Create** button | The **Create transition rule** pop-up opens that contains <li> Fields <ul><li> ***Root path*** - it is the path inside the storage, from which the search for files to transition <li> ***Glob*** - glob pattern for the file(s) to transfer <li> ***Method*** - method that defines the transition process (`One by one` is selected by default)  <li> ***Condition*** - additional condition (`Default` is selected by default) </ul><li> ***Transitions*** section that contains 1 destination row by default <ul><li> ***Destination*** - destination where files matches the glob pattern will be transferred <li> ***Date*** - date when files match the glob pattern will be transferred with 2 variants: ***After...days*** (selected by default) and ***At*** _specific date_ <li> ***Delete*** icon (disable if only 1 destination is added) <li> **+ Add** button </ul><li> ***Notify*** section that disabled by default. |
| 6 | Input `/` value into ***Root path*** field | |
| 7 | Input `*.*` value into ***Glob*** field | |
| 8 | Click ***Method*** field | Drop-down with `One by one`, `By the earliest file`, `By the latest file` options opens |
| 9 | Click ***Condition*** field | Drop-down with `Default`, `Files matches` options opens |
| 10 | Select `Files matches` option | ***Matches*** field appears under the ***Condition*** field |
| 11 | Input `*.txt` value into ***Matches*** field | |
| 12 | In the ***Transitions*** section <li> Select `S3 Glacier Flexible Retrieval` option for ***Destination*** <li> Input `2` value into the ***After*** field | |
| 13 | Click ***Method*** field and select `By the earliest file` option | ***Notify*** section becomes active and contains <li> ***Disable all notifications for the current rule*** checkbox <li> ***Recipients*** - list of recipients who shall receive notifications <li> ***Notice period (days)*** - period before the transition when the notification about further transition will be sent <li> ***Prolongation period (days)*** - period for which the transition can be delayed <li> ***Use default template*** checkbox (ticked by default) |
| 14 | Untick the ***Use default template*** checkbox | ***Subject*** and ***Notification*** fields appears that contains template from **DATASTORAGE_LIFECYCLE_ACTION** email notification |
| 15 | Tick the ***Use default template*** checkbox | |
| 16 | Input non-admin `User1` from the Prerequisites into the  ***Recipients*** field | |
| 17 | Click **Save** button | Table with 3 columns _Root_, _Glob_ and _Transition_ appears under the **Create** button that contains <li> 1 row with values `/`, `*.*` and `S3 Glacier Flexible Retrieval` in the corresponding columns <li> buttons *Edit*, *History* and *Remove* are shown for that row |